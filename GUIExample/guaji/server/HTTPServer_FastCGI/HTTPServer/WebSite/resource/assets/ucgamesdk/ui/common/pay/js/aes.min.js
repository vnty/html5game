var Aes={};!function(){function a(){function a(a){var b,c,d;for(a||(a=8),b=new Array(a),c=[],d=0;256>d;d++)c[d]=d;for(d=0;d<b.length;d++)b[d]=c[Math.floor(Math.random()*c.length)];return b}this.setDefaults=function(){this.params.nBits=256,this.params.salt=a(8),this.params.salt=pidCryptUtil.byteArray2String(this.params.salt),this.params.salt=pidCryptUtil.convertToHex(this.params.salt),this.params.blockSize=16,this.params.UTF8=!0,this.params.A0_PAD=!0},this.debug=!0,this.params={},this.params.dataIn="",this.params.dataOut="",this.params.decryptIn="",this.params.decryptOut="",this.params.encryptIn="",this.params.encryptOut="",this.params.key="",this.params.iv="",this.params.clear=!0,this.setDefaults(),this.errors="",this.warnings="",this.infos="",this.debugMsg="",this.setParams=function(a){a||(a={});for(var b in a)this.params[b]=a[b]},this.getParams=function(){return this.params},this.getParam=function(a){return this.params[a]||""},this.clearParams=function(){this.params={}},this.getNBits=function(){return this.params.nBits},this.getOutput=function(){return this.params.dataOut},this.setError=function(a){this.error=a},this.appendError=function(a){return this.errors+=a,""},this.getErrors=function(){return this.errors},this.isError=function(){return this.errors.length>0?!0:!1},this.appendInfo=function(a){return this.infos+=a,""},this.getInfos=function(){return this.infos},this.setDebug=function(a){this.debug=a},this.appendDebug=function(a){return this.debugMsg+=a,""},this.isDebug=function(){return this.debug},this.getAllMessages=function(a){var c,d,e,f,b={lf:"\n",clr_mes:!1,verbose:15};a||(a=b);for(c in b)"undefined"==typeof a[c]&&(a[c]=b[c]);d="",e="";for(f in this.params){switch(f){case"encryptOut":e=pidCryptUtil.toByteArray(this.params[f].toString()),e=pidCryptUtil.fragment(e.join(),64,a.lf);break;case"key":case"iv":e=pidCryptUtil.formatHex(this.params[f],48);break;default:e=pidCryptUtil.fragment(this.params[f].toString(),64,a.lf)}d+="<p><b>"+f+"</b>:<pre>"+e+"</pre></p>"}return this.debug&&(d+="debug: "+this.debug+a.lf),this.errors.length>0&&1==(1&a.verbose)&&(d+="Errors:"+a.lf+this.errors+a.lf),this.warnings.length>0&&2==(2&a.verbose)&&(d+="Warnings:"+a.lf+this.warnings+a.lf),this.infos.length>0&&4==(4&a.verbose)&&(d+="Infos:"+a.lf+this.infos+a.lf),this.debug&&8==(8&a.verbose)&&(d+="Debug messages:"+a.lf+this.debugMsg+a.lf),a.clr_mes&&(this.errors=this.infos=this.warnings=this.debug=""),d},this.getRandomBytes=function(b){return a(b)}}pidCryptUtil={},pidCryptUtil.encodeBase64=function(a,b){var c,d,e,f,g,h,i,j,k,n,o,p,l,m;if(a||(a=""),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b="undefined"==typeof b?!1:b,l=[],m="",o=b?pidCryptUtil.encodeUTF8(a):a,n=o.length%3,n>0)for(;n++<3;)m+="=",o+="\0";for(n=0;n<o.length;n+=3)d=o.charCodeAt(n),e=o.charCodeAt(n+1),f=o.charCodeAt(n+2),g=d<<16|e<<8|f,h=63&g>>18,i=63&g>>12,j=63&g>>6,k=63&g,l[n/3]=c.charAt(h)+c.charAt(i)+c.charAt(j)+c.charAt(k);return p=l.join(""),p=p.slice(0,p.length-m.length)+m},pidCryptUtil.decodeBase64=function(a,b){var c,d,e,f,g,h,i,j,k,m,n,l,o;for(a||(a=""),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b="undefined"==typeof b?!1:b,l=[],n=b?pidCryptUtil.decodeUTF8(a):a,o=0;o<n.length;o+=4)g=c.indexOf(n.charAt(o)),h=c.indexOf(n.charAt(o+1)),i=c.indexOf(n.charAt(o+2)),j=c.indexOf(n.charAt(o+3)),k=g<<18|h<<12|i<<6|j,d=255&k>>>16,e=255&k>>>8,f=255&k,l[o/4]=String.fromCharCode(d,e,f),64==j&&(l[o/4]=String.fromCharCode(d,e)),64==i&&(l[o/4]=String.fromCharCode(d));return m=l.join(""),m=b?pidCryptUtil.decodeUTF8(m):m},pidCryptUtil.encodeUTF8=function(a){return a||(a=""),a=a.replace(/[\u0080-\u07ff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(192|b>>6,128|63&b)}),a=a.replace(/[\u0800-\uffff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(224|b>>12,128|63&b>>6,128|63&b)})},pidCryptUtil.decodeUTF8=function(a){return a||(a=""),a=a.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(a){var b=(31&a.charCodeAt(0))<<6|63&a.charCodeAt(1);return String.fromCharCode(b)}),a=a.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(a){var b=(15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2);return String.fromCharCode(b)})},pidCryptUtil.convertToHex=function(a){var b,c,d;for(a||(a=""),b="",c="",d=0;d<a.length;d++)c=a.charCodeAt(d).toString(16),b+=1==c.length?"0"+c:c;return b},pidCryptUtil.convertFromHex=function(a){var b,c;for(a||(a=""),b="",c=0;c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.substring(c,c+2),16));return b},pidCryptUtil.stripLineFeeds=function(a){a||(a="");var b="";return b=a.replace(/\n/g,""),b=b.replace(/\r/g,"")},pidCryptUtil.toByteArray=function(a){var b,c;for(a||(a=""),b=[],c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b},pidCryptUtil.fragment=function(a,b,c){var d,e;if(a||(a=""),!b||b>=a.length)return a;for(c||(c="\n"),d="",e=0;e<a.length;e+=b)d+=a.substr(e,b)+c;return d},pidCryptUtil.formatHex=function(a,b){var c,e,f;for(a||(a=""),b||(b=45),c="",e=a.toLowerCase(),f=0;f<e.length;f+=2)c+=e.substr(f,2)+":";return e=this.fragment(c,b)},pidCryptUtil.byteArray2String=function(a){var c,b="";for(c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},"undefined"!=typeof a&&(a.MD5=function(a){function b(a,b){return a<<b|a>>>32-b}function c(a,b){var c,d,e,f,g;return e=2147483648&a,f=2147483648&b,c=1073741824&a,d=1073741824&b,g=(1073741823&a)+(1073741823&b),c&d?2147483648^g^e^f:c|d?1073741824&g?3221225472^g^e^f:1073741824^g^e^f:g^e^f}function d(a,b,c){return a&b|~a&c}function e(a,b,c){return a&c|b&~c}function f(a,b,c){return a^b^c}function g(a,b,c){return b^(a|~c)}function h(a,e,f,g,h,i,j){return a=c(a,c(c(d(e,f,g),h),j)),c(b(a,i),e)}function i(a,d,f,g,h,i,j){return a=c(a,c(c(e(d,f,g),h),j)),c(b(a,i),d)}function j(a,d,e,g,h,i,j){return a=c(a,c(c(f(d,e,g),h),j)),c(b(a,i),d)}function k(a,d,e,f,h,i,j){return a=c(a,c(c(g(d,e,f),h),j)),c(b(a,i),d)}function l(a){for(var b,c=a.length,d=c+8,e=(d-d%64)/64,f=16*(e+1),g=Array(f-1),h=0,i=0;c>i;)b=(i-i%4)/4,h=8*(i%4),g[b]=g[b]|a.charCodeAt(i)<<h,i++;return b=(i-i%4)/4,h=8*(i%4),g[b]=g[b]|128<<h,g[f-2]=c<<3,g[f-1]=c>>>29,g}function m(a){var d,e,b="",c="";for(e=0;3>=e;e++)d=255&a>>>8*e,c="0"+d.toString(16),b+=c.substr(c.length-2,2);return b}var o,p,q,r,s,t,u,v,w,N,n=Array(),x=7,y=12,z=17,A=22,B=5,C=9,D=14,E=20,F=4,G=11,H=16,I=23,J=6,K=10,L=15,M=21;for(n=l(a),t=1732584193,u=4023233417,v=2562383102,w=271733878,o=0;o<n.length;o+=16)p=t,q=u,r=v,s=w,t=h(t,u,v,w,n[o+0],x,3614090360),w=h(w,t,u,v,n[o+1],y,3905402710),v=h(v,w,t,u,n[o+2],z,606105819),u=h(u,v,w,t,n[o+3],A,3250441966),t=h(t,u,v,w,n[o+4],x,4118548399),w=h(w,t,u,v,n[o+5],y,1200080426),v=h(v,w,t,u,n[o+6],z,2821735955),u=h(u,v,w,t,n[o+7],A,4249261313),t=h(t,u,v,w,n[o+8],x,1770035416),w=h(w,t,u,v,n[o+9],y,2336552879),v=h(v,w,t,u,n[o+10],z,4294925233),u=h(u,v,w,t,n[o+11],A,2304563134),t=h(t,u,v,w,n[o+12],x,1804603682),w=h(w,t,u,v,n[o+13],y,4254626195),v=h(v,w,t,u,n[o+14],z,2792965006),u=h(u,v,w,t,n[o+15],A,1236535329),t=i(t,u,v,w,n[o+1],B,4129170786),w=i(w,t,u,v,n[o+6],C,3225465664),v=i(v,w,t,u,n[o+11],D,643717713),u=i(u,v,w,t,n[o+0],E,3921069994),t=i(t,u,v,w,n[o+5],B,3593408605),w=i(w,t,u,v,n[o+10],C,38016083),v=i(v,w,t,u,n[o+15],D,3634488961),u=i(u,v,w,t,n[o+4],E,3889429448),t=i(t,u,v,w,n[o+9],B,568446438),w=i(w,t,u,v,n[o+14],C,3275163606),v=i(v,w,t,u,n[o+3],D,4107603335),u=i(u,v,w,t,n[o+8],E,1163531501),t=i(t,u,v,w,n[o+13],B,2850285829),w=i(w,t,u,v,n[o+2],C,4243563512),v=i(v,w,t,u,n[o+7],D,1735328473),u=i(u,v,w,t,n[o+12],E,2368359562),t=j(t,u,v,w,n[o+5],F,4294588738),w=j(w,t,u,v,n[o+8],G,2272392833),v=j(v,w,t,u,n[o+11],H,1839030562),u=j(u,v,w,t,n[o+14],I,4259657740),t=j(t,u,v,w,n[o+1],F,2763975236),w=j(w,t,u,v,n[o+4],G,1272893353),v=j(v,w,t,u,n[o+7],H,4139469664),u=j(u,v,w,t,n[o+10],I,3200236656),t=j(t,u,v,w,n[o+13],F,681279174),w=j(w,t,u,v,n[o+0],G,3936430074),v=j(v,w,t,u,n[o+3],H,3572445317),u=j(u,v,w,t,n[o+6],I,76029189),t=j(t,u,v,w,n[o+9],F,3654602809),w=j(w,t,u,v,n[o+12],G,3873151461),v=j(v,w,t,u,n[o+15],H,530742520),u=j(u,v,w,t,n[o+2],I,3299628645),t=k(t,u,v,w,n[o+0],J,4096336452),w=k(w,t,u,v,n[o+7],K,1126891415),v=k(v,w,t,u,n[o+14],L,2878612391),u=k(u,v,w,t,n[o+5],M,4237533241),t=k(t,u,v,w,n[o+12],J,1700485571),w=k(w,t,u,v,n[o+3],K,2399980690),v=k(v,w,t,u,n[o+10],L,4293915773),u=k(u,v,w,t,n[o+1],M,2240044497),t=k(t,u,v,w,n[o+8],J,1873313359),w=k(w,t,u,v,n[o+15],K,4264355552),v=k(v,w,t,u,n[o+6],L,2734768916),u=k(u,v,w,t,n[o+13],M,1309151649),t=k(t,u,v,w,n[o+4],J,4149444226),w=k(w,t,u,v,n[o+11],K,3174756917),v=k(v,w,t,u,n[o+2],L,718787259),u=k(u,v,w,t,n[o+9],M,3951481745),t=c(t,p),u=c(u,q),v=c(v,r),w=c(w,s);return N=m(t)+m(u)+m(v)+m(w),N.toLowerCase()}),"undefined"!=typeof a&&(a.AES=function(b){this.env=b?b:new a,this.blockSize=16,this.ShiftRowTabInv,this.xtime,this.SBox=new Array(99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22),this.SBoxInv=new Array(82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125),this.ShiftRowTab=new Array(0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11)},a.AES.prototype.init=function(){this.env.setParams({blockSize:this.blockSize}),this.ShiftRowTabInv=new Array(16);for(var a=0;16>a;a++)this.ShiftRowTabInv[this.ShiftRowTab[a]]=a;for(this.xtime=new Array(256),a=0;128>a;a++)this.xtime[a]=a<<1,this.xtime[128+a]=27^a<<1},a.AES.prototype.expandKey=function(a){var d,f,g,h,b=a.slice(),c=b.length,e=1;switch(c){case 16:d=176;break;case 24:d=208;break;case 32:d=240;break;default:alert("AESCore.expandKey: Only key lengths of 16, 24 or 32 bytes allowed!")}for(f=c;d>f;f+=4)for(g=b.slice(f-4,f),0==f%c?(g=new Array(this.SBox[g[1]]^e,this.SBox[g[2]],this.SBox[g[3]],this.SBox[g[0]]),(e<<=1)>=256&&(e^=283)):c>24&&16==f%c&&(g=new Array(this.SBox[g[0]],this.SBox[g[1]],this.SBox[g[2]],this.SBox[g[3]])),h=0;4>h;h++)b[f+h]=b[f+h-c]^g[h];return b},a.AES.prototype.encrypt=function(a,b){var e,c=b.length,d=a.slice();for(this.addRoundKey(d,b.slice(0,16)),e=16;c-16>e;e+=16)this.subBytes(d),this.shiftRows(d),this.mixColumns(d),this.addRoundKey(d,b.slice(e,e+16));return this.subBytes(d),this.shiftRows(d),this.addRoundKey(d,b.slice(e,c)),d},a.AES.prototype.decrypt=function(a,b){var e,c=b.length,d=a.slice();for(this.addRoundKey(d,b.slice(c-16,c)),this.shiftRows(d,1),this.subBytes(d,1),e=c-32;e>=16;e-=16)this.addRoundKey(d,b.slice(e,e+16)),this.mixColumns_Inv(d),this.shiftRows(d,1),this.subBytes(d,1);return this.addRoundKey(d,b.slice(0,16)),d},a.AES.prototype.subBytes=function(a,b){var d,c="undefined"==typeof b?this.SBox.slice():this.SBoxInv.slice();for(d=0;16>d;d++)a[d]=c[a[d]]},a.AES.prototype.addRoundKey=function(a,b){for(var c=0;16>c;c++)a[c]^=b[c]},a.AES.prototype.shiftRows=function(a,b){var e,c="undefined"==typeof b?this.ShiftRowTab.slice():this.ShiftRowTabInv.slice(),d=(new Array).concat(a);for(e=0;16>e;e++)a[e]=d[c[e]]},a.AES.prototype.mixColumns=function(a){var b,c,d,e,f,g;for(b=0;16>b;b+=4)c=a[b+0],d=a[b+1],e=a[b+2],f=a[b+3],g=c^d^e^f,a[b+0]^=g^this.xtime[c^d],a[b+1]^=g^this.xtime[d^e],a[b+2]^=g^this.xtime[e^f],a[b+3]^=g^this.xtime[f^c]},a.AES.prototype.mixColumns_Inv=function(a){var b,c,d,e,f,g,h,i,j;for(b=0;16>b;b+=4)c=a[b+0],d=a[b+1],e=a[b+2],f=a[b+3],g=c^d^e^f,h=this.xtime[g],i=this.xtime[this.xtime[h^c^e]]^g,j=this.xtime[this.xtime[h^d^f]]^g,a[b+0]^=i^this.xtime[c^d],a[b+1]^=j^this.xtime[d^e],a[b+2]^=i^this.xtime[e^f],a[b+3]^=j^this.xtime[f^c]},a.AES.prototype.xOr_Array=function(a,b){var c,d=Array();for(c=0;c<a.length;c++)d[c]=a[c]^b[c];return d},a.AES.prototype.getCounterBlock=function(){var e,a=new Array(this.blockSize),b=(new Date).getTime(),c=Math.floor(b/1e3),d=b%1e3;for(e=0;4>e;e++)a[e]=255&c>>>8*e;for(e=0;4>e;e++)a[e+4]=255&d;return a.slice()}),"undefined"!=typeof a&&"undefined"!=typeof a.AES&&"undefined"!=typeof a.MD5&&(a.AES.CBC=function(){this.pidcrypt=new a,this.aes=new a.AES(this.pidcrypt),this.getOutput=function(){return this.pidcrypt.getOutput()},this.getAllMessages=function(a){return this.pidcrypt.getAllMessages(a)},this.isError=function(){return this.pidcrypt.isError()}},a.AES.CBC.prototype.init=function(a,b){var c,d,e,f;b||(b={}),c=this.pidcrypt,c.setDefaults(),d=this.pidcrypt.getParams();for(e in b)d[e]=b[e];f=this.createKeyAndIv({password:a,salt:d.salt,bits:d.nBits}),d.key=f.key,d.iv=f.iv,d.dataOut="",c.setParams(d),this.aes.init()},a.AES.CBC.prototype.initEncrypt=function(a,b,c){this.init(b,c),this.pidcrypt.setParams({dataIn:a,encryptIn:pidCryptUtil.toByteArray(a)})},a.AES.CBC.prototype.initDecrypt=function(a,b,c){var d,e,f;c||(c={}),d=this.pidcrypt,d.setParams({dataIn:a}),b||d.appendError("pidCrypt.AES.CBC.initFromEncryption: Sorry, can not crypt or decrypt without password.\n"),e=pidCryptUtil.decodeBase64(a),0!=e.indexOf("Salted__")&&d.appendError("pidCrypt.AES.CBC.initFromCrypt: Sorry, unknown encryption method.\n"),f=e.substr(8,8),c.salt=pidCryptUtil.convertToHex(f),this.init(b,c),e=e.substr(16),d.setParams({decryptIn:pidCryptUtil.toByteArray(e)})},a.AES.CBC.prototype.initByValues=function(a,b,c,d){var e={};this.init("",d),e.dataIn=a,e.key=b,e.iv=c,this.pidcrypt.setParams(e)},a.AES.CBC.prototype.getAllMessages=function(a){return this.pidcrypt.getAllMessages(a)},a.AES.CBC.prototype.createKeyAndIv=function(b){var g,h,i,j,k,l,m,c=this.pidcrypt,d={},e=1,f="3";for(b||(b={}),b.salt||(b.salt=c.getRandomBytes(8),b.salt=pidCryptUtil.convertToHex(pidCryptUtil.byteArray2String(b.salt)),c.setParams({salt:b.salt})),g=b.password+pidCryptUtil.convertFromHex(b.salt),h="",i="",j=[],k=0,j[k++]=g,l=0;f>l;l++){for(0==l?i=g:(h=pidCryptUtil.convertFromHex(i),h+=g,i=h),m=0;e>m;m++)i=a.MD5(i);j[k++]=i}switch(b.bits){case 128:d.key=j[1],d.iv=j[2];break;case 192:d.key=j[1]+j[2].substr(0,16),d.iv=j[3];break;case 256:d.key=j[1]+j[2],d.iv=j[3];break;default:c.appendError("pidCrypt.AES.CBC.createKeyAndIv: Sorry, only 128, 192 and 256 bits are supported.\nBits("+typeof b.bits+") = "+b.bits)}return d},a.AES.CBC.prototype.encryptRaw=function(a){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,b=this.pidcrypt,c=this.aes,d=b.getParams();for(a||(a=d.encryptIn),b.setParams({encryptIn:a}),d.dataIn||b.setParams({dataIn:a}),e=pidCryptUtil.convertFromHex(d.iv),f=d.blockSize-(a.length+1)%d.blockSize,d.A0_PAD&&(a[a.length]=10),g=0;f>g;g++)a[a.length]=f;for(h=Math.floor(d.nBits/8),i=new Array(h),j=pidCryptUtil.convertFromHex(d.key),k=0;h>k;k++)i[k]=isNaN(j.charCodeAt(k))?0:j.charCodeAt(k);for(l=c.expandKey(i),m=Math.ceil(a.length/d.blockSize),n=new Array(m),o=[],p=pidCryptUtil.toByteArray(e),q=0;m>q;q++)o=a.slice(q*d.blockSize,q*d.blockSize+d.blockSize),p=c.xOr_Array(p,o),p=c.encrypt(p.slice(),l),n[q]=pidCryptUtil.byteArray2String(p);return r=n.join(""),b.setParams({dataOut:r,encryptOut:r}),!b.isDebug()&&b.clear&&b.clearParams(),r||""},a.AES.CBC.prototype.encrypt=function(a){var e,b=this.pidcrypt,c="",d=b.getParams();return a||(a=d.dataIn),d.UTF8&&(a=pidCryptUtil.encodeUTF8(a)),b.setParams({dataIn:a,encryptIn:pidCryptUtil.toByteArray(a)}),e=this.encryptRaw(),c="Salted__"+pidCryptUtil.convertFromHex(d.salt),e=pidCryptUtil.encodeBase64(e),b.setParams({dataOut:e}),!b.isDebug()&&b.clear&&b.clearParams(),e||""},a.AES.CBC.prototype.encryptText=function(a,b,c){return this.initEncrypt(a,b,c),this.encrypt()},a.AES.CBC.prototype.decryptRaw=function(a){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,b=this.aes,c=this.pidcrypt,d=c.getParams();if(a||(a=d.decryptIn),c.setParams({decryptIn:a}),d.dataIn||c.setParams({dataIn:a}),d.iv.length/2<d.blockSize)return c.appendError("pidCrypt.AES.CBC.decrypt: Sorry, can not decrypt without complete set of parameters.\n Length of key,iv:"+d.key.length+","+d.iv.length);if(e=pidCryptUtil.convertFromHex(d.iv),0!=a.length%d.blockSize)return c.appendError("pidCrypt.AES.CBC.decrypt: Sorry, the encrypted text has the wrong length for aes-cbc mode\n Length of ciphertext:"+a.length+a.length%d.blockSize);for(f=Math.floor(d.nBits/8),g=new Array(f),h=pidCryptUtil.convertFromHex(d.key),i=0;f>i;i++)g[i]=isNaN(h.charCodeAt(i))?0:h.charCodeAt(i);for(j=b.expandKey(g),k=Math.ceil(a.length/d.blockSize),l=new Array(k.length),m=pidCryptUtil.toByteArray(e),n=[],o=[],p=0;k>p;p++)n=a.slice(p*d.blockSize,p*d.blockSize+d.blockSize),o=b.decrypt(n,j),l[p]=pidCryptUtil.byteArray2String(b.xOr_Array(m,o)),m=n.slice();return q=l.join(""),c.isDebug()&&c.appendDebug("Padding after decryption:"+pidCryptUtil.convertToHex(q)+":"+q.length+"\n"),r=q.charCodeAt(q.length-1),d.A0_PAD?q=q.substr(0,q.length-(r+1)):(s=q.length-(q.length-r),t=q.charCodeAt(q.length-r),r==t&&r==s&&(q=q.substr(0,q.length-r))),c.setParams({dataOut:q,decryptOut:q}),!c.isDebug()&&c.clear&&c.clearParams(),q||""},a.AES.CBC.prototype.decrypt=function(a){var d,e,b=this.pidcrypt,c=b.getParams();return a&&b.setParams({dataIn:a}),c.decryptIn||(d=pidCryptUtil.decodeBase64(c.dataIn),0==d.indexOf("Salted__")&&(d=d.substr(16)),b.setParams({decryptIn:pidCryptUtil.toByteArray(d)})),e=this.decryptRaw(),c.UTF8&&(e=pidCryptUtil.decodeUTF8(e)),b.isDebug()&&b.appendDebug("Removed Padding after decryption:"+pidCryptUtil.convertToHex(e)+":"+e.length+"\n"),b.setParams({dataOut:e}),!b.isDebug()&&b.clear&&b.clearParams(),e||""},a.AES.CBC.prototype.decryptText=function(a,b,c){return this.initDecrypt(a,b,c),this.decrypt()}),Aes.encrypt=function(b,c){var d,e,f;return c=pidCryptUtil.convertToHex(c),d=c,e=new a.AES.CBC,e.initByValues(b,c,d,{nBits:128}),f=e.encrypt()},Aes.decrypt=function(b,c){var d,e;return c=pidCryptUtil.convertToHex(c),d=c,aes=new a.AES.CBC,aes.initByValues(b,c,d,{nBits:128,A0_PAD:!1}),e=aes.decrypt()}}();